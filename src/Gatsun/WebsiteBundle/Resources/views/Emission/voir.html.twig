{% extends "::base.html.twig" %}
{% block title %}{{ emission.nom }} &ndash; {{ parent() }}{% endblock %}
{% block body %}
	<section class="panel panel-default">
        <div class="panel-heading">
	       <h1>{{ emission.nom }}</h1>
        </div>
        <div class="panel-body">
            {% if emission.bandeau != null %}
            <img class="bandeau" src="{{ asset(emission.bandeau) }}" alt="{{ emission.nom }}" title="{{ emission.nom }}" /><br />
            {% endif %}
            {{ emission.description }}
            <br />
            {% if app.user in emission.presentateurs or is_granted('ROLE_ADMIN') %}
                <div class="btn-group btn-group-justified">
                    <a href="{{ path('gatsun_website_emission_modifier', { 'id': emission.id }) }}" class="btn btn-default btn-info">
                        <span class="glyphicon glyphicon-pencil"></span>
                         Modifier l'émission
                    </a>
                    <a href="{{ path('gatsun_website_publication_ajouter') }}" class="btn btn-default btn-success">
                        <span class="glyphicon glyphicon-plus"></span>
                         Ajouter un article
                    </a>
                </div>
            {% endif %}

            {% for publication in publications %}
            <div class="media">
                <a class="pull-left" href="{{ path('gatsun_website_publication', {'id': publication.id}) }}">
                    <img class="media-object" src="{{ asset(publication.vignette) }}">
                </a>
                <div class="media-body">
                    <h2 class="media-heading">
                        <a href="{{ path('gatsun_website_publication', {'id': publication.id}) }}">{{ publication.titre }}</a>
                    </h2>
                    <aside>
                        Par {{ publication.utilisateur.username }}, le {{ publication.date|date('d/m/Y') }}
                    </aside>
                    <p>
                        {% spaceless %}
                            {{ publication.contenu|code|striptags|slice(0, 255) }}
                            {% if publication.contenu|length > 255 %}
                                …
                            {% endif %}
                        {% endspaceless %}
                    </p>
                    <p class="pull-right">
                        {% if is_granted('ROLE_ADMIN') or publication.utilisateur == app.user %}
                            <a href="{{ path('gatsun_website_publication_supprimer', {'id': publication.id}) }}"class="btn btn-default btn-danger">
                                <i class="fa fa-trash"></i>
                                Supprimer
                            </a>
                            <a href="{{ path('gatsun_website_publication_modifier', {'id': publication.id}) }}"class="btn btn-default btn-info">
                                <i class="fa fa-pencil"></i>
                                Modifier
                            </a>
                        {% endif %}
                        <a class="btn btn-primary" href="{{ path('gatsun_website_publication', {'id': publication.id}) }}">
                            <i class="fa fa-bullhorn"></i>
                            {% if publication.contenu|length > 255 %}
                                Suite et commentaires&hellip;
                            {% else %}
                                Commentaires&hellip;
                            {% endif %}
                        </a>
                    </p>
                </div>
            </div>
            {% else %}
            Pas de publications.
            {% endfor %}
        </div>
    </section>
{% endblock %}
{% block stylesheets %}
<link rel="stylesheet" media="screen" type="text/css" href="{{ asset('css/emission.css') }}" />
{% endblock %}